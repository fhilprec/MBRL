Compiling...
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/fhilprec/MBRL/MBRL/actor_critic.py", line 374, in <module>
    train_jit.lower(rng).compile()
  File "/home/fhilprec/MBRL/MBRL/actor_critic.py", line 324, in train
    runner_state, metric = jax.lax.scan(
  File "/home/fhilprec/MBRL/MBRL/actor_critic.py", line 306, in _update_step
    if config.get("CHECKPOINT_DIR") and train_state.n_updates % config.get("SAVE_FREQ", 10) == 0:
jax.errors.TracerBoolConversionError: Attempted boolean conversion of traced array with shape bool[].
The error occurred while tracing the function _update_step at /home/fhilprec/MBRL/MBRL/actor_critic.py:149 for scan. This concrete value was not available in Python because it depends on the values of the arguments runner_state[0].step, runner_state[0].params['params']['Dense_0']['bias'], runner_state[0].params['params']['Dense_0']['kernel'], runner_state[0].params['params']['Dense_1']['bias'], runner_state[0].params['params']['Dense_1']['kernel'], runner_state[0].params['params']['Dense_2']['bias'], runner_state[0].params['params']['Dense_2']['kernel'], runner_state[0].params['params']['Dense_3']['bias'], runner_state[0].params['params']['Dense_3']['kernel'], runner_state[0].params['params']['Dense_4']['bias'], runner_state[0].params['params']['Dense_4']['kernel'], runner_state[0].params['params']['Dense_5']['bias'], runner_state[0].params['params']['Dense_5']['kernel'], runner_state[0].opt_state[1][0].count, runner_state[0].opt_state[1][0].mu['params']['Dense_0']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_0']['kernel'], runner_state[0].opt_state[1][0].mu['params']['Dense_1']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_1']['kernel'], runner_state[0].opt_state[1][0].mu['params']['Dense_2']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_2']['kernel'], runner_state[0].opt_state[1][0].mu['params']['Dense_3']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_3']['kernel'], runner_state[0].opt_state[1][0].mu['params']['Dense_4']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_4']['kernel'], runner_state[0].opt_state[1][0].mu['params']['Dense_5']['bias'], runner_state[0].opt_state[1][0].mu['params']['Dense_5']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_0']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_0']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_1']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_1']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_2']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_2']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_3']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_3']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_4']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_4']['kernel'], runner_state[0].opt_state[1][0].nu['params']['Dense_5']['bias'], runner_state[0].opt_state[1][0].nu['params']['Dense_5']['kernel'], runner_state[0].opt_state[1][1].count, runner_state[0].timesteps, runner_state[0].n_updates, runner_state[1].env_state.env_state.player_x, runner_state[1].env_state.env_state.player_y, runner_state[1].env_state.env_state.player_direction, runner_state[1].env_state.env_state.oxygen, runner_state[1].env_state.env_state.divers_collected, runner_state[1].env_state.env_state.score, runner_state[1].env_state.env_state.lives, runner_state[1].env_state.env_state.spawn_state.difficulty, runner_state[1].env_state.env_state.spawn_state.lane_dependent_pattern, runner_state[1].env_state.env_state.spawn_state.to_be_spawned, runner_state[1].env_state.env_state.spawn_state.survived, runner_state[1].env_state.env_state.spawn_state.prev_sub, runner_state[1].env_state.env_state.spawn_state.spawn_timers, runner_state[1].env_state.env_state.spawn_state.diver_array, runner_state[1].env_state.env_state.spawn_state.lane_directions, runner_state[1].env_state.env_state.diver_positions, runner_state[1].env_state.env_state.shark_positions, runner_state[1].env_state.env_state.sub_positions, runner_state[1].env_state.env_state.enemy_missile_positions, runner_state[1].env_state.env_state.surface_sub_position, runner_state[1].env_state.env_state.player_missile_position, runner_state[1].env_state.env_state.step_counter, runner_state[1].env_state.env_state.just_surfaced, runner_state[1].env_state.env_state.successful_rescues, runner_state[1].env_state.env_state.death_counter, runner_state[1].env_state.env_state.rng_key, runner_state[1].env_state.step, runner_state[1].env_state.prev_action, runne
See https://docs.jax.dev/en/latest/errors.html#jax.errors.TracerBoolConversionError
